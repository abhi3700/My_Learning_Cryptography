# Zero Knowledge Proof

## Overview

- 3 core properties for any ZKP:
  1. Completeness: Given a statement and a witness, the prover can convince the verifier.
  2. Soundness: A malicious prover cannot convince the verifier of a false statement.
  3. Zero-knowledge: The proof does not reveal anything but the truth of the statement, in particular it does not reveal the prover’s witness.
- **Use cases**:
  - [Tornado Cash](./tornado-cash/)
  - Zcash (private transactions) -> zkSNARK Groth16
  - fast light clients/compact blockchain (Celo, Mina)
  - Filecoin (provable decentralized storage)
    > It verifies [2M Groth16 SNARKS per day](https://spacegap.github.io/#/)

## Tools

### Editor

- [VSCode](https://github.com/abhi3700/my_coding_toolkit/blob/main/vsc_all.md)
- Extensions:
  - [circom-highlighting-vscode](https://marketplace.visualstudio.com/items?itemName=iden3.circom)

## Algorithms

![](../../img/zkp-algorithms-complexity.png)

![](../../img/zkp-algorithms.png)

### zk-SNARK

- zk-SNARK stands for zero-knowledge succinct **non-interactive** argument of knowledge.
- The most used system/protocol in SNARK is [Groth16](https://eprint.iacr.org/2016/260.pdf) by Jens Groth.
- Some more protocols are:
  - Libra
  - Sonic
  - SuperSonic
  - PlonK
  - SLONK
  - Halo
  - Marlin
  - Fractal
  - Spartan
  - Succinct Aurora,
  - RedShift,
  - AirAssembly
- depends on elliptic-curves.
- trusted setup is required. This means that the keys (b/w proof required for sending private txn & verification) are generated by a trusted party. So, these secrets need to be destroyed or else the secrets could be utilized to forge transactions by false verifications, giving the holder the ability to perform actions such as creating new tokens out of thin air and using them for transactions.
- The proof system/protocol (Groth16) requires a **structured reference string** (SRS) i.e. a vector of elements specially crafted for a specific computation. The trusted setup (a complicated setup is required in order to generate keys that prover & verifier can use to verify the proofs.
- And because of its demand & increased usage in a network, it faces a scalability problem.
- The **reason** is that all the nodes in the network have to process each proof individually to agree on the final state, which enforces an implicit limit as to how many proofs the network can verify per day.
- Solutions to scalability issues:

  - **Proof carrying data** (currently being considered by Mina & Halo2 (Zcash)) => this would give birth to a new system/protocol creation in zkSNARK.
  - **aggregated Groth16 proofs** (currently being used by Filecoin to scale their network) together, yielding a logarithmic-sized proof and not requiring any change in the proof system/protocol itself! In other words, one can aggregate current proofs and bring scalability to the current systems without drastic changes!
    > SnarkPack can aggregate `8192` proofs in `8` seconds, producing a proof which is `38x` smaller in size and can be verified in `33ms`, including deserialization. The scheme scales logarithmically, yielding an exponentially faster verification scheme than batching: the more you aggregate, the faster you can verify a proof.

  ![](../../img/zkp-aggregated-groth16.png)

- Once quantum computing is largely available, the privacy technology behind SNARKs would be broken. So, zk-SNARKs are not quantum-resistant.
- SNARK was the 1st to come to the market before STARK.
- Better documentation & community support.
- txn cost for zk-SNARK is 24% of zk-STARK.
- on-chain proof size for zk-SNARK is much smaller than zk-STARK.
- A `Rust` lib called [bellman](https://github.com/zkcrypto/bellman) which uses zk-SNARK's groth16 protocol.
- A `Rust` lib called [arkworks-rs/groth16](https://github.com/arkworks-rs/groth16) which uses zk-SNARK's groth16 protocol.
- A `Go` lib called [gnark](https://docs.gnark.consensys.net/en/stable/) which uses zk-SNARK's groth16 protocol.
  > 4x faster than `bellman` (written in Rust)
- A `JS` lib called [snarkjs](https://github.com/iden3/snarkjs) which uses zk-SNARK.
- A language called [Circom](https://github.com/iden3/circom) which helps in writing the cryptographic circuits behind zk-SNARKs.
  > Also, comes with a compiler called `Circom compiler` which compiles the circuit into a `R1CS` file and a program (in C++ or wasm) to efficiently compute a valid assignment to all wires of the circuit. Refer [this](#circom) for more.
- Major contributor: [arkworks](https://github.com/arkworks-rs/)
  - They have contributed mostly along with `iden3`.

### zk-STARK

- zk-STARK stands for zero-knowledge scalable **transparent** argument of knowledge.
- depends on hash function.
- That's why quantum-resistant unlike SNARK where it depends on encryption like elliptic-curves.
- less documentation
- txn cost for zk-SNARK is 24% of zk-STARK.
- on-chain proof size for zk-SNARK is much smaller than zk-STARK. That being said, STARKs have far larger proof sizes than SNARKs, which means that verifying STARKs takes more time than SNARKs and also leads to STARKs requiring more gas.
- funded by Ethereum Foundation with 12M USD.
- A language called [Cairo](https://www.cairo-lang.org/) which helps in writing the cryptographic circuits behind zk-STARKs.

## Languages

There has been many languages developed to help in writing the cryptographic circuits behind zkp. Here are some of them:

### [Circom](./langs/circom/)

### [Cairo](./langs/cairo/)

## Examples

Here are the examples/case studies:

- [Tornado Cash](./tornado-cash/)

## References

- [ZKP](https://en.wikipedia.org/wiki/Zero-knowledge_proof)
- [zk-snark in _Rust_](https://github.com/zkcrypto/bellman)

### Blogs

- [Everything I know about ZKP](https://wiki.nikiv.dev/security/cryptography/zero-knowledge-proofs)
- [Understanding Zero-Knowledge Proofs Through the Source Code of Tornado Cash](https://betterprogramming.pub/understanding-zero-knowledge-proofs-through-the-source-code-of-tornado-cash-41d335c5475f)
- [Zero-Knowledge Proofs Using SnarkJS and Circom](https://betterprogramming.pub/zero-knowledge-proofs-using-snarkjs-and-circom-fac6c4d63202)
- [SnarkPack: How to aggregate SNARKs efficiently | Protocol Labs Filecoin](https://research.protocol.ai/blog/2021/snarkpack-how-to-aggregate-snarks-efficiently/)
- [Libraries for finite field, elliptic curve, and polynomial arithmetic](https://github.com/arkworks-rs/algebra)

### Videos

- [Dystopia Labs | (Part 1/3) Demystifying Zero Knowledge Proofs: How To Build DApps With zk-SNARKs](https://www.youtube.com/watch?v=_6TqUNVLChc)
- [Dystopia Labs | (Part 2/3) Demystifying Zero Knowledge Proofs: How To Build DApps With zk-SNARKs](https://www.youtube.com/watch?v=qwtOJvFo6vs)
- [Dystopia Labs | (Part 3/3) Demystifying Zero Knowledge Proofs: How To Build DApps With zk-SNARKs](https://www.youtube.com/watch?v=YymE69JcKEk)
- [Intro to Zcash | An Evening with Zooko Wilcox, Founder of Zcash (Singapore 2019)](https://www.youtube.com/watch?v=BSgMpEfTQiA)
- [Solidity Dev to ZK Dev: Why and How You Should Start ZK Dev Now](https://www.youtube.com/watch?v=wyBNZzLEgkA)
- [Scalability is Boring, Privacy is Dead: ZK-Proofs, What are They Good for? by Ian Miers](https://www.youtube.com/watch?v=AX7eAzfSB6w)
- [Proof of x from H(x) using zkSnarks for Solidity Smart Contracts](https://www.youtube.com/watch?v=NMa479P8r0Y)
- [STARKS I - Arithmetization Eli Ben Sasson Technion Cyber Computer Security](https://www.youtube.com/watch?v=9VuZvdxFZQo)
- [StarkNet House 2022 Sessions](https://www.youtube.com/playlist?list=PLC6CxTQU-oBgOSOdG8964L87SzjWcHtiY)

### Motivational

- [What to know about Zero Knowledge | Devcon Bogotá](https://www.youtube.com/watch?v=hBupNf1igbY) ✅
- [Designing Public Goods Using ZKPs by Rachel | Devcon Bogotá](https://www.youtube.com/watch?v=qWcU2saOlw4)
- [Practical Use Cases for Zero-Knowledge](https://medium.com/@aleohq/practical-use-cases-for-zero-knowledge-d8e5be5dfe46)
